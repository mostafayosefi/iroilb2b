import{_ as T,h as k,i as _,R as L,j as f,o as p,c as g,b as c,a as t,w as a,v as u,t as r,n as d,m as V,s as j,q as b,d as x,l as O,F as v,k as U,e as w,r as y,p as I,g as q}from"./app.c6c6a3cb.js";const P={props:{site:Object,user:Object},components:{accountHeader:k(()=>_(()=>import("./account-header.5b9985a6.js"),["assets/account-header.5b9985a6.js","assets/app.c6c6a3cb.js","assets/app.c39a63c1.css"])),accountFooter:k(()=>_(()=>import("./account-footer.88d063a8.js"),["assets/account-footer.88d063a8.js","assets/app.c6c6a3cb.js","assets/app.c39a63c1.css"])),VueTelInput:L},emits:["getUser"],data(){return{isLoading:!1,loginState:"email",phone:"",email:"",password:"",code:"",step:1,countDown:120,bindProps:{validCharactersOnly:!0,ignoredCountries:["IL"],enabledCountryCode:!0,autoFormat:!1,inputOptions:{placeholder:this.$t("phone-input",this.$route.params.lang)}},country:null,messageAlert:[],placeHolderCode:this.$route.params.lang=="fa"?"tel98547":"",error:!1}},methods:{countryChanged(e){this.country=e.dialCode},login(){if(this.loginState=="email"&&this.emailCheck()&&this.password.length!=0){this.error=!1,this.isLoading=!0;const e={lang:this.$route.params.lang,type:"email",email:this.email,password:this.password};f.post("/login",e).then(s=>{if(s.data.status==204){let l=s.data.error;this.messageAlert.push(l),setTimeout(()=>this.messageAlert=this.messageAlert.filter(n=>n!=l),4e3)}else if(s.data.status==203)this.countDownTimer(),this.step=2;else{this.$router.push({name:"sitePanel"});const l={id:s.data.data.id,token:s.data.data.token,role:s.data.data.role,session:"25j_7Sl6xDq2Kc3ym0fmrSSk2xV2XkUkX"};this.$cookies.set("user",l,"180d"),this.$emit("getUser")}this.isLoading=!1}).catch(s=>{this.isLoading=!1;let l=this.$t("incorect-user",this.$route.params.lang,{data:this.$t("email",this.$route.params.lang)});this.messageAlert.push(l),setTimeout(()=>this.messageAlert=this.messageAlert.filter(n=>n!=l),4e3)})}else if(this.loginState=="phone"&&this.phoneCheck()&&this.password.length!=0){this.error=!1,this.isLoading=!0;const e={lang:this.$route.params.lang,type:"phone",phone:this.country+this.phone,password:this.password};f.post("/login",e).then(s=>{if(s.data.status==204){let l=s.data.error;this.messageAlert.push(l),setTimeout(()=>this.messageAlert=this.messageAlert.filter(n=>n!=l),4e3)}else if(s.data.status==203)this.countDownTimer(),this.step=2;else{this.$router.push({name:"sitePanel"});const l={id:s.data.data.id,token:s.data.data.token,role:s.data.data.role,session:"25j_7Sl6xDq2Kc3ym0fmrSSk2xV2XkUkX"};this.$cookies.set("user",l,"180d"),this.$emit("getUser")}this.isLoading=!1}).catch(s=>{this.isLoading=!1;let l=this.$t("incorect-user",this.$route.params.lang,{data:this.$t("mobile",this.$route.params.lang)});this.messageAlert.push(l),setTimeout(()=>this.messageAlert=this.messageAlert.filter(n=>n!=l),4e3)})}else this.loginState=="email"&&this.emailCheck()&&(this.error=!0,setTimeout(()=>this.error=!1,5e3)),this.loginState=="phone"&&this.phoneCheck()&&(this.error=!0,setTimeout(()=>this.error=!1,5e3))},emailCheck(){var e=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;if(this.email.match(e))return!0;{let s=this.$t("email-check",this.$route.params.lang);return this.messageAlert.push(s),setTimeout(()=>this.messageAlert=this.messageAlert.filter(l=>l!=s),4e3),!1}},phoneCheck(){let e=this.$t("phone-error",this.$route.params.lang);return this.phone.length<10?(this.messageAlert.push(e),setTimeout(()=>this.messageAlert=this.messageAlert=this.messageAlert.filter(s=>s!=e),4e3),!1):(this.messageAlert=this.messageAlert.filter(s=>s!=e),!0)},countDownTimer(){this.countDown>0&&setTimeout(()=>{this.countDown-=1,this.countDownTimer()},1e3)},setCountDown(e){this.countDown=e},sentAgain(e){this.isLoading=!0;let s={type:e,email:this.email,phone:this.country+this.phone};f.post("/login/code",s).then(l=>{l.status==200&&(this.setCountDown(120),this.countDownTimer()),this.isLoading=!1}).catch(l=>{this.isLoading=!1})},authenticate(e){this.isLoading=!0;let s={email:this.email,phone:this.country+this.phone,code:this.code,type:e};f.post("/login/auth",s).then(l=>{if(l.data.status==200){this.$router.push({name:"sitePanel"});const n={id:l.data.data.id,token:l.data.data.token,role:l.data.data.role,session:"25j_7Sl6xDq2Kc3ym0fmrSSk2xV2XkUkX"};this.$cookies.set("user",n,"180d"),this.$emit("getUser")}else{let n=this.$t("not-valied",this.$route.params.lang);this.messageAlert.push(n),setTimeout(()=>this.messageAlert=this.messageAlert.filter(o=>o!=n),4e3)}this.isLoading=!1}).catch(l=>{this.isLoading=!1})}},beforeCreate(){if(this.$route.query.id&&this.$route.query.role&&this.$route.query.token){const e={id:parseInt(this.$route.query.id),token:this.$route.query.token,role:this.$route.query.role,session:"25j_7Sl6xDq2Kc3ym0fmrSSk2xV2XkUkX"};this.$cookies.set("user",e,"180d")}this.$cookies.isKey("user")&&(this.$router.push({name:"sitePanel"}),this.$emit("getUser"))},watch:{$route:{immediate:!0,handler(e,s){document.title=this.$t("login",this.$route.params.lang)+" - "+this.$t("user-account",this.$route.params.lang)+" | "+document.title}}}},m=e=>(I("data-v-35bcff10"),e=e(),q(),e),X={class:"md:flex justify-center py-5 w-full lg:w-4/5 xl:w-2/3 m-auto md:mt-10"},F={class:"w-full md:w-1/2 relative"},E={class:"blur-login"},H=m(()=>t("img",{class:"loader",src:"/images/loading.svg",alt:"loading"},null,-1)),K=[H],z={class:"w-full rounded-lg shadow-lg p-4 md:p-10"},N={class:"font-bold text-xl"},R=["href"],B={dir:"ltr",class:"relative mt-5 flex w-full flex-wrap items-stretch"},G=m(()=>t("span",{class:"z-10 h-full font-normal absolute text-center bg-transparent rounded items-center justify-center w-10 px-5 py-3 text-slate-400"},[t("i",{class:"fe fe-mail text-xl"})],-1)),M=["placeholder"],J={dir:"ltr",class:"relative mt-5 flex w-full flex-wrap items-stretch"},Q=m(()=>t("span",{class:"z-10 h-full font-normal absolute text-center bg-transparent rounded items-center justify-center w-10 px-5 py-3 text-slate-400"},[t("i",{class:"fe fe-lock text-xl"})],-1)),W=["placeholder"],Y={class:"w-full rounded-lg shadow-lg p-10"},Z={key:0,class:"py-5"},ee={class:"text-center text-red-700 text-xl bold"},te={key:1,class:"py-5"},se={dir:"ltr",class:"relative flex w-full flex-wrap items-stretch"},oe=m(()=>t("span",{class:"z-10 h-full font-normal absolute text-center bg-transparent rounded items-center justify-center w-10 px-5 py-3 text-slate-400"},[t("i",{class:"fe fe-smartphone text-xl"})],-1)),le=["placeholder"],re=["disabled"],ie={class:"text-red-600 relative m-4"},ae=m(()=>t("span",{class:"text-xl inline-block mx-2 align-middle"},[t("i",{class:"fe fe-bell"})],-1)),ne={class:"text-red-600 relative m-4"},ue={class:"inline-block w-full align-middle bg-red-50 border-red-600 my-1 p-3 border-2 rounded-lg"},de=m(()=>t("span",{class:"text-xl inline-block mx-2 align-middle"},[t("i",{class:"fe fe-bell"})],-1)),me={class:"w-full md:w-1/2 text-sm"},he={class:"w-full sm:flex p-10"},pe={class:"w-full sm:w-1/2 flex justify-center"},ge=["src"],ce={class:"text-dark-primary"},fe={class:"mt-2"},we={class:"w-full sm:flex p-10 flex-row-reverse"},ye={class:"w-full sm:w-1/2 flex justify-center"},be=["src"],$e={class:"text-dark-primary"},ke={class:"mt-2"};function _e(e,s,l,n,o,h){const S=y("accountHeader"),C=y("vue-tel-input"),$=y("router-link"),A=y("accountFooter");return p(),g(v,null,[c(S,{site:l.site},null,8,["site"]),t("div",X,[t("div",F,[a(t("div",E,K,512),[[u,o.isLoading]]),a(t("div",z,[t("h2",N,r(e.$t("welcome",e.$route.params.lang)),1),t("section",{class:d(["mt-5 space-x-2",e.$route.params.lang=="fa"?"space-x-reverse":""])},[t("button",{onClick:s[0]||(s[0]=i=>o.loginState="email"),class:d(["text-xs font-semibold inline-block py-1 px-2 rounded-lg text-blueGray-600 bg-gray-200 last:mr-0 mr-1 border-2 mb-1 md:mb-0",o.loginState=="email"?"border-slate-500":""])},r(e.$t("login-with-email",e.$route.params.lang)),3),t("button",{onClick:s[1]||(s[1]=i=>o.loginState="phone"),class:d(["text-xs font-semibold inline-block py-1 px-2 rounded-lg text-blueGray-600 bg-gray-200 last:mr-0 mr-1 border-2",o.loginState=="phone"?"border-slate-500":""])},r(e.$t("login-with-phone",e.$route.params.lang)),3),t("a",{href:e.$sitename+e.$route.params.lang+"/auth",class:"text-xs font-semibold inline-block py-1 px-2 rounded-lg text-blueGray-600 bg-gray-200 last:mr-0 mr-1 border-2"},r(e.$t("login-with-google",e.$route.params.lang)),9,R)],2),t("form",{onSubmit:s[7]||(s[7]=V(()=>{},["prevent"]))},[a(c(C,j({modelValue:o.phone,"onUpdate:modelValue":s[2]||(s[2]=i=>o.phone=i),dir:"ltr",styleClasses:["w-full mt-5 block p-2 border border-slate-300 rounded-lg focus:outline-none focus:ring focus:ring-gray-300 text-gray-400"],item:o.placeHolderCode,onCountryChanged:h.countryChanged},o.bindProps),null,16,["modelValue","item","onCountryChanged"]),[[u,o.loginState=="phone"]]),a(t("div",B,[G,a(t("input",{"onUpdate:modelValue":s[3]||(s[3]=i=>o.email=i),dir:"ltr",type:"email",placeholder:e.$t("email",e.$route.params.lang),class:d([e.$route.params.lang=="fa"?"placeholder:text-right":"","py-3 placeholder-slate-400 w-full border border-slate-300 rounded-lg p-2 focus:outline-none focus:ring focus:ring-gray-300 p-3 text-gray-400 pl-14"])},null,10,M),[[b,o.email]])],512),[[u,o.loginState=="email"]]),t("div",J,[Q,a(t("input",{"onUpdate:modelValue":s[4]||(s[4]=i=>o.password=i),dir:"ltr",type:"password",placeholder:e.$t("password",e.$route.params.lang),class:d([e.$route.params.lang=="fa"?"placeholder:text-right":"","py-3 placeholder-slate-400 w-full border border-slate-300 rounded-lg p-2 focus:outline-none focus:ring focus:ring-gray-300 p-3 text-gray-400 mb-2 pl-14"])},null,10,W),[[b,o.password]])]),c($,{to:{name:"siteForgot"},class:"text-blue-500 text-sm"},{default:x(()=>[w(r(e.$t("forgot-password",e.$route.params.lang)),1)]),_:1}),a(t("button",{onClick:s[5]||(s[5]=i=>h.login()),class:"bg-dark-primary text-white font-bold uppercase text-xs py-3 rounded-full outline-none my-5 w-full focus:ring focus:ring-slate-300",type:"button"},r(e.$t("login",e.$route.params.lang)),513),[[u,o.loginState=="email"]]),a(t("button",{onClick:s[6]||(s[6]=i=>h.login()),class:"bg-dark-primary text-white font-bold uppercase text-xs py-3 rounded-full outline-none my-5 w-full focus:ring focus:ring-slate-300",type:"button"},r(e.$t("login",e.$route.params.lang)),513),[[u,o.loginState=="phone"]])],32),t("span",null,r(e.$t("sign-up-now",e.$route.params.lang)+" "),1),c($,{to:{name:"siteSignup"},class:"text-blue-500"},{default:x(()=>[w(r(e.$t("signup",e.$route.params.lang)+" "+e.$t("O-signup",e.$route.params.lang)),1)]),_:1})],512),[[u,o.step==1]]),a(t("div",Y,[o.countDown>0?(p(),g("div",Z,[t("p",ee,r(o.countDown+" "+e.$t("seconds",e.$route.params.lang)),1)])):o.countDown==0?(p(),g("div",te,[t("p",{onClick:s[8]||(s[8]=i=>h.sentAgain(o.phone!=""?"phone":"email")),class:"text-center text-slate-400",style:{cursor:"pointer"}},r(e.$t("sent-again-code",e.$route.params.lang)),1)])):O("",!0),t("p",null,r(e.$t("inter-code",e.$route.params.lang)),1),a(t("span",{class:"float-left mt-5 text-slate-400"},r(o.phone),513),[[u,o.phone!=""]]),a(t("span",{class:"float-left mt-5 text-slate-400"},r(o.email),513),[[u,o.email!=""]]),t("div",se,[oe,a(t("input",{dir:"ltr",type:"number","onUpdate:modelValue":s[9]||(s[9]=i=>o.code=i),placeholder:e.$t("submit-code",e.$route.params.lang),class:d([e.$route.params.lang=="fa"?"placeholder:text-right":"","py-3 placeholder-slate-400 w-full border border-slate-300 rounded-lg p-2 focus:outline-none focus:ring focus:ring-gray-300 p-3 text-gray-400 mb-2 pl-14"])},null,10,le),[[b,o.code]])]),t("button",{onClick:s[10]||(s[10]=i=>h.authenticate(o.phone!=""?"phone":"email")),disabled:o.code.length<2,class:"bg-dark-primary text-white font-bold uppercase text-xs py-3 rounded-full outline-none my-5 w-full focus:ring focus:ring-slate-300",type:"button"},r(e.$t("authenticate",e.$route.params.lang)),9,re)],512),[[u,o.step==2]]),a(t("section",ie,[(p(!0),g(v,null,U(o.messageAlert,(i,D)=>(p(),g("strong",{class:"inline-block w-full align-middle bg-red-50 border-red-600 my-1 p-3 border-2 rounded-lg",key:D},[ae,w(" "+r(i),1)]))),128))],512),[[u,o.messageAlert[0]]]),a(t("section",ne,[t("strong",ue,[de,w(" "+r(e.$t("password-error",e.$route.params.lang)),1)])],512),[[u,o.error]])]),t("div",me,[t("section",he,[t("div",pe,[t("img",{width:"300",class:"h-fit",src:e.$sitename+"images//login-right-img.png",alt:"login"},null,8,ge)]),t("div",{class:d(["w-full sm:w-1/2 mt-2 md:mt-0 text-center",e.$route.params.lang=="fa"?"sm:text-right":"sm:text-left"])},[t("strong",ce,r(e.$t("login-top-header",e.$route.params.lang)),1),t("p",fe,r(e.$t("login-top-text",e.$route.params.lang)),1)],2)]),t("section",we,[t("div",ye,[t("img",{width:"300",class:"h-fit",src:e.$sitename+"images//login-left-img.png",alt:"login"},null,8,be)]),t("div",{class:d(["w-full sm:w-1/2 mt-2 md:mt-0 text-center",e.$route.params.lang=="fa"?"sm:text-right":"sm:text-left"])},[t("strong",$e,r(e.$t("login-bottom-header",e.$route.params.lang)),1),t("p",ke,r(e.$t("login-bottom-text",e.$route.params.lang)),1)],2)])])]),c(A,{site:l.site},null,8,["site"])],64)}const ve=T(P,[["render",_e],["__scopeId","data-v-35bcff10"]]);export{ve as default};
