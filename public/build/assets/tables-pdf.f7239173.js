import{_ as j,h as B,i as E,j as C,o as r,c,b as x,d as V,w as i,v as u,a as t,e as H,t as b,n as I,q as p,F as _,k as f,r as U,p as L,g as S}from"./app.c6c6a3cb.js";import{d as T}from"./vuedraggable.umd.16f25545.js";var g=0,v=0;const A={emits:["loadingHide","loading"],props:{loading:Boolean,user:Object},components:{"header-admin":B(()=>E(()=>import("./header-admin.6f180bbb.js"),["assets/header-admin.6f180bbb.js","assets/app.c6c6a3cb.js","assets/app.c39a63c1.css"])),draggable:T},data(){return{loading:!0,header:[],data:[],dragging:!1,table:{id:"",title:"",water:"",detail:{description:""}},error:!1}},methods:{addHeader(){this.header.push({id:g,title:""}),g++},addRow(){this.data.push({col:[]})},addCol(e){this.data[e].col.push({id:v,title:""}),v++},removeRow(e){this.data=this.data.filter((o,l,d)=>l!==e)},removeCol(e,o){this.data[e].col=this.data[e].col.filter((l,d,s)=>d!==o)},removeHeader(e){this.header=this.header.filter((o,l,d)=>l!==e)},getPdf(){this.table.title!=""?(this.$emit("loading"),this.error=!1,C.get("/table/pdf",{params:{api_token:this.$cookies.get("user").token,title:this.table.title,water:this.table.water,detail:this.table.detail,header:this.header,data:this.data},responseType:"blob"}).then(e=>{const o=window.URL.createObjectURL(new Blob([e.data])),l=document.createElement("a");l.href=o,l.setAttribute("download",this.table.title.toLowerCase()+" "+this.table.detail.description.toLowerCase()+".pdf"),document.body.appendChild(l),l.click(),l.remove(),this.$emit("loadingHide")}).catch(()=>{this.$emit("loadingHide")})):this.error=!0}},computed:{draggingInfo(){return this.dragging?"under drag":""}},beforeCreate(){C.get("/table/id/"+this.$route.params.id,{params:{api_token:this.$cookies.get("user").token}}).then(e=>{this.table.id=e.data.id,this.table.title=e.data.title,this.table.detail.description=e.data.detail.description;for(const l of e.data.header)this.header.push({id:l.id,title:l.title}),g=l.id+1;var o=0;for(const l of e.data.data){this.data.push({col:[]});for(const d of l.col)this.data[o].col.push({id:d.id,title:d.title}),v=l.id+1;o++}this.$emit("loadingHide")}).catch(()=>{this.$emit("loadingHide")})},watch:{$route:{immediate:!0,handler(e,o){document.title=this.$t("tables")+" | "+this.$t("adminTitlePage")}}}},w=e=>(L("data-v-eedc5cf1"),e=e(),S(),e),D={class:"content"},N={class:"alert alert-outline-danger alert-dismissible show flex items-center col-span-12 bg-white mt-2 font-bold",role:"alert"},O=w(()=>t("i",{"data-feather":"alert-octagon",class:"w-6 h-6 ml-2"},null,-1)),F={class:"box intro-y p-4"},q={class:"alert alert-outline-danger alert-dismissible show flex items-center col-span-12 mb-2",role:"alert"},z=w(()=>t("i",{"data-feather":"alert-octagon",class:"w-6 h-6 ml-2"},null,-1)),M=["placeholder"],G=["placeholder"],J=["placeholder"],K={dir:"ltr"},Q={class:"mt-2"},W={class:"float-left"},X={class:"inline"},Y=["onUpdate:modelValue"],Z=["onClick"],ee={class:"bg-white py-2 rounded"},te={class:"flex align-items-center"},le={class:"inline"},oe=["onUpdate:modelValue"],ae=["onClick"],se=["onClick"],ie=["onClick"],de=w(()=>t("button",{class:"btn handle"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-align-justify block mx-auto"},[t("line",{x1:"21",y1:"10",x2:"3",y2:"10"}),t("line",{x1:"21",y1:"6",x2:"3",y2:"6"}),t("line",{x1:"21",y1:"14",x2:"3",y2:"14"}),t("line",{x1:"21",y1:"18",x2:"3",y2:"18"})])],-1));function ne(e,o,l,d,s,n){const P=U("header-admin"),R=U("draggable");return r(),c("div",D,[x(P,{user:l.user,title:e.$t("pdf-maker")},{default:V(()=>[i(t("button",{type:"button",onClick:o[0]||(o[0]=a=>n.addHeader()),class:"btn btn-sm font-bold btn-success ml-2"},b(e.$t("add-header")),513),[[u,l.user.role.table.edit]]),i(t("button",{type:"button",onClick:o[1]||(o[1]=a=>n.addRow()),class:"btn btn-sm font-bold btn-success ml-2"},b(e.$t("add-data")),513),[[u,l.user.role.table.edit]]),i(t("button",{type:"button",onClick:o[2]||(o[2]=a=>n.getPdf()),class:"btn btn-sm font-bold btn-dark ml-2"},b(e.$t("pdf-download")),513),[[u,l.user.role.table.edit]])]),_:1},8,["user","title"]),i(t("div",N,[O,H(" "+b(e.$t("access-message")),1)],512),[[u,!l.user.role.table.edit]]),i(t("div",F,[i(t("div",q,[z,H(" "+b(e.$t("error-empty-fields")),1)],512),[[u,s.error]]),i(t("input",{dir:"rtl",type:"text",class:I(["form-control",s.error&&s.table.title==""?"alert-outline-danger":""]),placeholder:e.$t("title"),"onUpdate:modelValue":o[3]||(o[3]=a=>s.table.title=a)},null,10,M),[[p,s.table.title]]),i(t("input",{dir:"ltr",type:"text",class:"form-control mt-2",placeholder:e.$t("water-marker"),"onUpdate:modelValue":o[4]||(o[4]=a=>s.table.water=a)},null,8,G),[[p,s.table.water]]),i(t("input",{dir:"ltr",type:"text",class:"form-control mt-2",placeholder:e.$t("description"),"onUpdate:modelValue":o[5]||(o[5]=a=>s.table.detail.description=a)},null,8,J),[[p,s.table.detail.description]]),t("div",K,[t("table",Q,[t("thead",W,[t("tr",X,[(r(!0),c(_,null,f(s.header,(a,m)=>(r(),c("th",null,[i(t("input",{type:"text","onUpdate:modelValue":h=>a.title=h,class:"border-2 p-2 rounded border-solid border-theme-15 font-bold"},null,8,Y),[[p,a.title]]),t("button",{class:"btn btn-danger mx-1",onClick:h=>n.removeHeader(m)}," - ",8,Z)]))),256))])]),t("tbody",null,[x(R,{tag:"ul",list:s.data,class:"list-group",handle:".handle","item-key":"name"},{item:V(({element:a,index:m})=>[t("li",ee,[t("tr",te,[(r(!0),c(_,null,f(a,h=>(r(),c("div",le,[(r(!0),c(_,null,f(h,(k,$)=>(r(),c("td",null,[i(t("input",{type:"text","onUpdate:modelValue":y=>k.title=y,class:"border p-2 rounded"},null,8,oe),[[p,k.title]]),t("button",{class:"btn btn-danger mx-1",onClick:y=>n.removeCol(m,$)}," - ",8,ae)]))),256))]))),256)),t("button",{class:"btn btn-success mx-1",onClick:h=>n.addCol(m)}," + ",8,se),t("button",{class:"btn btn-dark mx-1",onClick:h=>n.removeRow(m)}," - ",8,ie),de])])]),_:1},8,["list"])])])])],512),[[u,l.user.role.table.edit]])])}const he=j(A,[["render",ne],["__scopeId","data-v-eedc5cf1"]]);export{he as default};
