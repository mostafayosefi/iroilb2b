import{_ as x,h as L,i as $,V as S,j as r,o as c,c as m,a as e,b as g,d as V,w as a,v as l,e as u,t as i,m as _,u as p,F as h,k as b,q as v,r as w}from"./app.c6c6a3cb.js";const T={emits:["loadingHide","loading"],props:{loading:Boolean,user:Object},components:{"header-admin":L(()=>$(()=>import("./header-admin.6f180bbb.js"),["assets/header-admin.6f180bbb.js","assets/app.c6c6a3cb.js","assets/app.c39a63c1.css"])),VueGoodTable:S},data(){return{csrf:document.querySelector('meta[name="csrf-token"]').getAttribute("content"),loading:!0,sendLoad:!1,successState:!1,error:!1,columns:[{label:this.$t("message"),field:"message"},{label:this.$t("sender"),field:"sender"},{label:this.$t("receiver"),field:"receiver"},{label:this.$t("status"),field:"status"},{label:this.$t("time"),field:"time"}],form:{text:"",user:"",tag:""},messages:[],users:[],products:[]}},methods:{singleSend(){this.sendLoad=!0,r.post("notification/singlesend",{api_token:this.$cookies.get("user").token,sender:this.$cookies.get("user").id,receiver:this.form.user,message:this.form.text}).then(s=>{s.data=="success"&&(this.sendLoad=!1,this.form.user="",this.form.text="",setTimeout(()=>this.successState=!1,2e3),this.$refs.toggleButton.click())})},multiSend(){this.sendLoad=!0,r.post("notification/multisend",{api_token:this.$cookies.get("user").token,sender:this.$cookies.get("user").id,tag:this.form.tag,message:this.form.text}).then(s=>{s.data=="success"&&(this.sendLoad=!1,this.form.tag="",this.form.text="",setTimeout(()=>this.successState=!1,2e3),this.$refs.toggleButton.click())})}},async beforeCreate(){await r.get("/notification",{params:{api_token:this.$cookies.get("user").token}}).then(s=>{for(const t of s.data)this.messages.push({id:t.id,sender:t.sender,receiver:t.receiver,status:t.status,message:t.message,time:t.time})}),await r.get("/users/all",{params:{api_token:this.$cookies.get("user").token}}).then(s=>{if(s!=null)for(const t of s.data.data)this.users.push({id:t.id,name:t.name})}),await r.get("/product",{params:{api_token:this.$cookies.get("user").token}}).then(s=>{if(s.data.data)for(const t of s.data.data)this.products.push({id:t.id,name:t.name_fa})}),this.$emit("loadingHide")},watch:{$route:{immediate:!0,handler(s,t){document.title=this.$t("messages-management")+" | "+this.$t("adminTitlePage")}}}},B={class:"content"},C={class:"alert alert-outline-danger alert-dismissible show flex items-center col-span-12 bg-white mt-2 font-bold",role:"alert"},E=e("i",{"data-feather":"alert-octagon",class:"w-6 h-6 ml-2"},null,-1),P={class:"box intro-y"},j={id:"basic-non-sticky-notification-content",class:"toastify-content hidden flex flex-col sm:flex-row"},M={class:"font-medium"},U={id:"basic-non-sticky-notification-toggle",ref:"toggleButton",class:"d-none"},A={id:"header-footer-modal-preview",class:"modal",tabindex:"-1"},D={class:"modal-dialog"},N={class:"modal-content"},q={class:"modal-header"},F={class:"font-medium text-left ml-auto"},H=["value"],O={class:"modal-body grid grid-cols-12 gap-4 gap-y-3"},G={class:"col-span-12 sm:col-span-12"},I={for:"user"},R=["value"],z={class:"col-span-12 sm:col-span-12"},J={class:"alert alert-outline-danger alert-dismissible show flex items-center col-span-12",role:"alert"},K=e("i",{"data-feather":"alert-octagon",class:"w-6 h-6 ml-2"},null,-1),Q={class:"modal-footer justify-end flex items-center"},W={type:"button","data-dismiss":"modal",class:"btn btn-outline-secondary w-20 mx-4"},X=["disabled"],Y=e("i",{"data-loading-icon":"puff",class:"w-5"},null,-1),Z=[Y],ee={id:"modal",class:"modal",tabindex:"-1"},se={class:"modal-dialog"},te={class:"modal-content"},oe={class:"modal-header"},ne={class:"font-medium text-left ml-auto"},ie=["value"],ae={class:"modal-body grid grid-cols-12 gap-4 gap-y-3"},le={class:"col-span-12 sm:col-span-12"},de={for:"user"},re=["value"],ce={class:"col-span-12 sm:col-span-12"},me={class:"alert alert-outline-danger alert-dismissible show flex items-center col-span-12",role:"alert"},ue=e("i",{"data-feather":"alert-octagon",class:"w-6 h-6 ml-2"},null,-1),he={class:"modal-footer justify-end flex items-center"},fe={type:"button","data-dismiss":"modal",class:"btn btn-outline-secondary w-20 mx-4"},ge=["disabled"],_e=e("i",{"data-loading-icon":"puff",class:"w-5"},null,-1),pe=[_e];function be(s,t,d,ve,o,f){const k=w("header-admin"),y=w("vue-good-table");return c(),m(h,null,[e("div",B,[g(k,{user:d.user,title:s.$t("messages-management"),element:d.user.role.notificate.add,elementText:s.$t("one-submit")},{default:V(()=>[a(e("a",{href:"javascript:;",class:"btn btn-sm btn-primary mx-1 font-bold","data-toggle":"modal","data-target":"#modal"},i(s.$t("group-submit")),513),[[l,d.user.role.notificate.add]])]),_:1},8,["user","title","element","elementText"]),a(e("div",C,[E,u(" "+i(s.$t("access-message")),1)],512),[[l,!d.user.role.notificate.show]]),a(e("div",P,[g(y,{class:"p-2",columns:o.columns,rows:o.messages,rtl:!0,theme:"polar-bear","line-numbers":!0,"fixed-header":!0,"pagination-options":{enabled:!0,mode:"records",perPage:10,nextLabel:s.$t("next"),prevLabel:s.$t("prev"),rowsPerPageLabel:"",ofLabel:s.$t("of"),allLabel:s.$t("all")},"search-options":{enabled:!0,placeholder:s.$t("search")}},null,8,["columns","rows","pagination-options","search-options"])],512),[[l,d.user.role.notificate.show]])]),e("div",j,[e("div",M,i(s.$t("add-success-message")),1)]),e("button",U,null,512),e("div",A,[e("div",D,[e("div",N,[e("div",q,[e("h2",F,i(s.$t("single-message")),1)]),e("form",{onSubmit:t[3]||(t[3]=_(()=>{},["prevent"]))},[e("input",{type:"hidden",name:"_token",value:o.csrf},null,8,H),e("div",O,[e("div",G,[e("label",I,i(s.$t("choose-user")),1),a(e("select",{id:"user","onUpdate:modelValue":t[0]||(t[0]=n=>o.form.user=n),class:"form-control mt-2"},[(c(!0),m(h,null,b(o.users,n=>(c(),m("option",{value:n.id},i(n.name),9,R))),256))],512),[[p,o.form.user]])]),e("div",z,[a(e("textarea",{class:"form-control",rows:"5","onUpdate:modelValue":t[1]||(t[1]=n=>o.form.text=n)},`\r
                          `,512),[[v,o.form.text]])]),a(e("div",J,[K,u(" "+i(s.$t("error-empty-fields")),1)],512),[[l,o.error]])]),e("div",Q,[e("button",W,i(s.$t("cancel")),1),e("button",{type:"button",onClick:t[2]||(t[2]=n=>f.singleSend()),class:"btn btn-success w-20",disabled:o.sendLoad},[a(e("div",null,i(s.$t("send")),513),[[l,!o.sendLoad]]),a(e("div",null,Z,512),[[l,o.sendLoad]])],8,X)])],32)])])]),e("div",ee,[e("div",se,[e("div",te,[e("div",oe,[e("h2",ne,i(s.$t("multi-message")),1)]),e("form",{onSubmit:t[7]||(t[7]=_(()=>{},["prevent"]))},[e("input",{type:"hidden",name:"_token",value:o.csrf},null,8,ie),e("div",ae,[e("div",le,[e("label",de,i(s.$t("choose-tag")),1),a(e("select",{id:"user","onUpdate:modelValue":t[4]||(t[4]=n=>o.form.tag=n),class:"form-control mt-2"},[(c(!0),m(h,null,b(o.products,n=>(c(),m("option",{value:n.id},i(n.name),9,re))),256))],512),[[p,o.form.tag]])]),e("div",ce,[a(e("textarea",{class:"form-control",rows:"5","onUpdate:modelValue":t[5]||(t[5]=n=>o.form.text=n)},`\r
                          `,512),[[v,o.form.text]])]),a(e("div",me,[ue,u(" "+i(s.$t("error-empty-fields")),1)],512),[[l,o.error]])]),e("div",he,[e("button",fe,i(s.$t("cancel")),1),e("button",{type:"button",onClick:t[6]||(t[6]=n=>f.multiSend()),class:"btn btn-success w-20",disabled:o.sendLoad},[a(e("div",null,i(s.$t("send")),513),[[l,!o.sendLoad]]),a(e("div",null,pe,512),[[l,o.sendLoad]])],8,ge)])],32)])])])],64)}const ke=x(T,[["render",be]]);export{ke as default};
